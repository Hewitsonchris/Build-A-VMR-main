!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexninepatch=e()}(this,function(){"use strict";function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(i){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=o(i);if(n){var r=o(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return a(this,t)}}function h(t,e,r){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=o(t)););return t}(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function _(t){var e,r,i;if("object"!==F(t)||null===t)return t;for(i in e=Array.isArray(t)?[]:{},t)r=t[i],e[i]=_(r);return e}function t(){}function i(i,p){var t=function(){s(y,i);var t,e,r,m=c(y);function y(t,e,r,i,n,s,o,a,c,h){var u;v(this,y),g(e)?(e=b(h=e,"x",0),r=b(h,"y",0),i=b(h,"width",1),n=b(h,"height",1),s=b(h,"key",void 0),o=b(h,"baseFrame",void 0),a=b(h,"columns",void 0),c=b(h,"rows",void 0)):g(i)?(i=b(h=i,"width",1),n=b(h,"height",1),s=b(h,"key",void 0),o=b(h,"baseFrame",void 0),a=b(h,"columns",void 0),c=b(h,"rows",void 0)):g(s)?(s=b(h=s,"key",void 0),o=b(h,"baseFrame",void 0),a=b(h,"columns",void 0),c=b(h,"rows",void 0)):g(o)?(o=b(h=o,"baseFrame",void 0),a=b(h,"columns",void 0),c=b(h,"rows",void 0)):Array.isArray(o)?(h=c,c=a,a=o,o=b(h,"baseFrame",void 0)):g(a)&&(a=b(h=a,"columns",void 0),c=b(h,"rows",void 0)),(u=m.call(this,t)).type=p,u.setPosition(e,r).setSize(i,n).setOrigin(.5,.5),u.columns={},u.rows={},u.stretchMode={},u._tileSprite=void 0,u._image=void 0,u.setGetFrameNameCallback(b(h,"getFrameNameCallback",void 0)),u.setStretchMode(b(h,"stretchMode",0)),u.setPreserveRatio(b(h,"preserveRatio",!0));var l=b(h,"maxFixedPartScale",1),f=b(h,"maxFixedPartScaleX",l),d=b(h,"maxFixedPartScaleY",void 0);return u.setMaxFixedPartScale(f,d),u.setTexture(s,o,a,c),u}return t=y,(e=[{key:"minWidth",get:function(){return this.columns.minWidth}},{key:"minHeight",get:function(){return this.rows.minHeight}},{key:"fixedPartScaleX",get:function(){return this.columns.scale}},{key:"fixedPartScaleY",get:function(){return this.rows.scale}},{key:"resize",value:function(t,e){return this.width===t&&this.height===e||(h(o(y.prototype),"resize",this).call(this,t,e),this.updateTexture()),this}}])&&n(t.prototype,e),r&&n(t,r),y}();return Object.assign(t.prototype,y),t}function u(t,e,r){return void 0===r&&(r="image"),t[e]||(t[e]=t.scene.make[r]({add:!1,origin:{x:0,y:0}}),t.once("destroy",function(){t[e]&&(t[e].destroy(),t[e]=void 0)})),t[e]}var e=function(t,e,r){return"__BASE"===r?"".concat(t,",").concat(e):"".concat(r,"_").concat(t,",").concat(e)},l=Phaser.Utils.Objects.IsPlainObject,f=Phaser.Utils.Objects.GetValue,d=function(t){return"string"==typeof t&&(t=m[t]),t},m={scale:0,repeat:1},y={_drawImage:t,_drawTileSprite:t,setGetFrameNameCallback:function(t){return void 0===t&&(t=e),this.getFrameNameCallback=t,this},setTexture:function(t,e,r,i){Array.isArray(e)&&(i=r,r=e,e=void 0),void 0===e&&(e="__BASE"),r=_(r),i=_(i),this.textureKey=t,this.baseFrameName=e,this.columns.data=r,this.columns.count=r?r.length:0,this.columns.stretch=0,this.columns.minWidth=0,this.columns.scale=1,this.rows.data=i,this.rows.count=i?i.length:0,this.rows.stretch=0,this.rows.minHeight=0,this.rows.scale=1;var n=this.scene.sys.textures.get(t);if(!n)return this.clear(),this;if(!r||!i)return this.clear(),this;for(var s=n.frames[e],o=s.width,a=0,c=0,h=r.length;c<h;c++)void 0===r[c]?a++:"number"==typeof r[c]?o-=r[c]:o-=r[c].width;var u=o/a,l=s.height,f=0;for(c=0,h=i.length;c<h;c++)void 0===i[c]?f++:"number"==typeof i[c]?l-=i[c]:l-=i[c].width;for(var d,m,y,p,v,g=l/f,b=0,w=0,x=0,S=i.length;x<S;x++){void 0===i[x]&&(i[x]=g),"number"==typeof i[x]&&(i[x]={height:i[x],stretch:x%2}),y=(d=i[x]).height,this.rows.stretch+=0|d.stretch,this.rows.minHeight+=0<d.stretch?0:y;c=b=0;for(var P=r.length;c<P;c++){if(void 0===r[c]&&(r[c]=u),"number"==typeof r[c]&&(r[c]={width:r[c],stretch:c%2}),p=(m=r[c]).width,0===x&&(this.columns.stretch+=0|m.stretch,this.columns.minWidth+=0<m.stretch?0:p),1<=p&&1<=y){var O=F(v=this.getFrameNameCallback(c,x,e));"string"!==O&&"number"!==O||n.add(v,0,b+s.cutX,w+s.cutY,p,y)}b+=p}w+=y}return this.updateTexture(),this},updateTexture:function(){if(this.clear(),void 0===this.textureKey)return this;var t=this.scene.sys.textures.get(this.textureKey);if(!t)return this;var e,r,i,n,s,o,a,c=this.columns.minWidth*this.maxFixedPartScaleX,h=this.rows.minHeight*this.maxFixedPartScaleY,u=this.width-c,l=this.height-h,f=0<=u?this.maxFixedPartScaleX:this.width/c,d=0<=l?this.maxFixedPartScaleY:this.height/h;if(this.preserveRatio){var m=Math.min(f,d);if(m<f){var y=(f-m)*c;0<=u?u+=y:u=y,f=m}if(m<d){var p=(d-m)*h;0<=l?l+=p:l=p,d=m}}this.columns.scale=f,this.rows.scale=d,e=0<u&&0<this.columns.stretch?u/this.columns.stretch:0,r=0<l&&0<this.rows.stretch?l/this.rows.stretch:0;for(var v=0,g=0,b=0,w=this.rows.count;b<w;b++){a=0===(s=this.rows.data[b]).stretch?s.height*d:r*s.stretch;for(var x=v=0,S=this.columns.count;x<S;x++)o=0===(n=this.columns.data[x]).stretch?n.width*f:e*n.stretch,i=this.getFrameNameCallback(x,b,this.baseFrameName),t.has(i)&&0<o&&0<a&&(0===(0===s.stretch&&0===n.stretch||0===this.getStretchMode(x,b)?0:1)?this._drawImage(this.textureKey,i,v,g,o,a):this._drawTileSprite(this.textureKey,i,v,g,o,a)),v+=o;g+=a}},setStretchMode:function(t){return l(t)?(this.stretchMode.edge=d(f(t,"edge",0)),this.stretchMode.internal=d(f(t,"internal",0))):(t=d(t),this.stretchMode.edge=t,this.stretchMode.internal=t),this},getStretchMode:function(t,e){return function(t,e){return 0===t||t===this.columns.count-1||0===e||e===this.rows.count-1}.call(this,t,e)?this.stretchMode.edge:this.stretchMode.internal},setPreserveRatio:function(t){return null==t&&(t=!0),this.preserveRatio=t,this},setMaxFixedPartScale:function(t,e){return void 0===e&&(e=t),this.maxFixedPartScaleX=t,this.maxFixedPartScaleY=e,this}},g=Phaser.Utils.Objects.IsPlainObject,b=Phaser.Utils.Objects.GetValue,p={_drawImage:function(t,e,r,i,n,s){var o=u(this,"_image","image").setTexture(t,e).setDisplaySize(n,s);this.draw(o,r,i)},_drawTileSprite:function(t,e,r,i,n,s){var o=u(this,"_tileSprite","tileSprite").setTexture(t,e).setSize(n,s);this.draw(o,r,i)}},w=Phaser.GameObjects.RenderTexture,x=function(){s(e,i(w,"rexNinePatch"));var t=c(e);function e(){return v(this,e),t.apply(this,arguments)}return e}();return Object.assign(x.prototype,p),x});
